<style>
  /* Reduce the top gap for this specific section */
  #shopify-section-{{ section.id }} { margin-top: 0 !important; padding-top: 0 !important; }
  #shopify-section-{{ section.id }} .community_grid_header { margin-top: 0 !important; padding-top: 0 !important; }
  #shopify-section-{{ section.id }} .community_grid_header h2 { margin-top: 0 !important; }
</style>

<div class="community_grid_header">
  <h2>{{ section.settings.main_title }}</h2>
</div>
{% for block in section.blocks %}
  <div
    id="modall_{{ forloop.index }}"
    class="modall"
    {% if forloop.index == 1 %}
      style="display: block;"
    {% endif %}
  >
    <div class="community_grid_section_modall">
      {%- capture image_sizes -%}
            (min-width: 720px) calc(calc(50vw - clamp(18px, 3.3vw, 3.3vw)), calc(100vw - 80px)
        {%- endcapture -%}
      {%- liquid
        assign prioritize_loading = false
        if section.index == 1
          assign prioritize_loading = true
        endif
        assign placeholder_aspect_ratio = 'square'
      -%}

      {%- if block.settings.mainimage != blank -%}
        {%- render 'image',
          wrapper_class: 'main_img lazyload',
          image: block.settings.mainimage,
          sizes: image_sizes,
          animate: true,
          include_placeholder: true,
          animate: true,
          prioritize_loading: prioritize_loading,
          placeholder_natural_fallback_ratio: placeholder_aspect_ratio,
          placeholder_name: 'lifestyle-2'
        -%}
      {%- else -%}
        {%- render 'image',
          wrapper_class: 'main_img lazyload',
          image: block.settings.image,
          sizes: image_sizes,
          animate: true,
          include_placeholder: true,
          animate: true,
          prioritize_loading: prioritize_loading,
          placeholder_natural_fallback_ratio: placeholder_aspect_ratio,
          placeholder_name: 'lifestyle-2'
        -%}
      {%- endif -%}
      <div class="modall_content">
        <h2 class="{{ block.settings.heading_size }}" {{ block.shopify_attributes }}>
          {{ block.settings.heading | escape }}
        </h2>
        <p class="modall_img">
          <img
            src="{{ block.settings.caption | append:'.png' | asset_url }}"
            alt="{{ block.settings.heading | escape }}"
          >
          {{- block.settings.caption | escape }}
        </p>
        <div class="modall_des">{{ block.settings.textarea }}</div>
      </div>
    </div>
  </div>
{% endfor %}

<div class="community_grid_section">
  <div class="community-grid-slider">
    {% for block in section.blocks %}
      <a class="popup_btnn" href="javascript:void(0);" data-modall="#modall_{{ forloop.index }}">
        <div>
          <div class="community-grid">
            {%- if block.settings.image != blank -%}
              {%- render 'image',
                wrapper_class: 'lazyload',
                image: block.settings.image,
                sizes: image_sizes,
                animate: true,
                include_placeholder: true,
                animate: true,
                prioritize_loading: prioritize_loading,
                placeholder_natural_fallback_ratio: placeholder_aspect_ratio,
                placeholder_name: 'lifestyle-2'
              -%}
            {%- else -%}
              {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
            {%- endif -%}
            <div class="community-grid-content">
              <h2 class="{{ block.settings.heading_size }}" {{ block.shopify_attributes }}>
                {{ block.settings.heading | escape }}
              </h2>
              <p class="image-with-text__text image-with-text__text--caption ">
                <img src="{{ block.settings.caption | append:'.png' | asset_url }}">
                {{- block.settings.caption | escape }}
              </p>
              <div class="rich-text__text rte" {{ block.shopify_attributes }}>{{ block.settings.text }}</div>
            </div>
          </div>
        </div>
      </a>
    {% endfor %}
  </div>
</div>

<script>
    $(".popup_btnn").on("click", function () {
      var modall = $(this).data("modall");
      $(modall).siblings('.modall').hide();
      $(modall).show();
    });
</script>

{% schema %}
{
  "name": "Community Grid Slider",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "main_title",
      "label": "Main Title"
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "block",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "text",
          "id": "caption",
          "default": "Add a tagline",
          "label": "Text"
        },
        {
          "type": "richtext",
          "id": "text",
          "default": "<p>Share information about your brand with your customers. Describe a product, make announcements, or welcome customers to your store.</p>",
          "label": "Description"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "textarea",
          "id": "textarea",
          "label": "description"
        },
        {
          "type": "image_picker",
          "id": "mainimage",
          "label": "Main Image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Community Grid Slider"
    }
  ]
}
{% endschema %}
